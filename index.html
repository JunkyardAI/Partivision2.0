<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PARTIVISION | Modular Visualizer v2.1</title>
  <link rel="stylesheet" href="css/style.css" />
</head>

<body>

  <!-- Header -->
  <div id="header">
    <div class="logo">
      <div>
        <h1>PARTIVISION<span>PRO</span></h1>
        <div class="tagline">Modular Audio Visualizer</div>
      </div>
    </div>

    <div class="header-actions">
      <button id="helpBtn" title="Help (?)">Help</button>
      <button id="hideUiBtn" title="Toggle UI (H)">Hide UI</button>
    </div>
  </div>

  <!-- Three.js Stage -->
  <div id="stage-container"></div>
  <div id="fps-counter">FPS: 60</div>

  <!-- Command Center -->
  <div id="command-center" class="glass-panel">

    <div class="panel-section">
      <h3>Input</h3>
      <input type="file" id="audioFile" accept="audio/*,video/*" />
      <button id="clearFileBtn" style="display:none;">Clear</button>
    </div>

    <div class="panel-section">
      <h3>Render</h3>

      <div class="control-row">
        <label>Resolution</label>
        <select id="canvasSize">
          <option value="window">Window</option>
          <option value="1080x1920">9:16</option>
          <option value="1920x1080">16:9</option>
          <option value="1080x1080">1:1</option>
        </select>
      </div>

      <div class="control-row">
        <label>Visual</label>
        <select id="visualMode">
          <option value="particles">Particles</option>
          <option value="sphere">Sphere</option>
          <option value="galaxy">Galaxy</option>
          <option value="terrain">Terrain</option>
          <option value="crystalline">Crystalline</option>
          <option value="parametricEq">Parametric EQ</option>
        </select>
      </div>

      <div class="control-row">
        <label>FFT</label>
        <select id="fftSize">
          <option value="512">512</option>
          <option value="1024">1024</option>
          <option value="2048" selected>2048</option>
          <option value="4096">4096</option>
        </select>
      </div>
    </div>

    <div class="panel-section">
      <h3>Console</h3>
      <div id="console-logs"></div>
      <div class="status-bar">
        <span>Engine</span>
        <span id="engineStatus">Idle</span>
      </div>
    </div>

  </div>

  <!-- Transport Bar -->
  <div id="transport-bar">
    <div class="transport-inner glass-panel">

      <button class="play-btn" id="playBtn">▶</button>
      <button class="pause-btn" id="pauseBtn" disabled>⏸</button>
      <button class="trans-btn" id="recordBtn">REC</button>
      <button class="trans-btn" id="snapshotBtn">PNG</button>

      <div class="scrubber">
        <div id="timeDisplay">0:00 / 0:00</div>
        <div id="progressBar">
          <div id="progressFill"></div>
        </div>
      </div>

      <input type="range" id="volume" min="0" max="100" value="70" />
    </div>
  </div>

  <!-- Drop Overlay -->
  <div id="drop-overlay">DROP FILE</div>

  <!-- Help Overlay -->
  <div id="help-overlay">
    <div class="help-content glass-panel">
      <h2>Shortcuts</h2>
      <div class="shortcut-list">
        <div><b>Space</b> Play / Pause</div>
        <div><b>H</b> Toggle UI</div>
        <div><b>D</b> Debug Console</div>
        <div><b>R</b> Record</div>
        <div><b>S</b> Snapshot</div>
        <div><b>Esc</b> Close Panels</div>
      </div>
      <button id="closeHelpBtn">Close</button>
    </div>
  </div>

  <!-- Draggable Panels -->
  <div id="camera-controls" class="settings-panel" style="right:20px;">
    <div class="panel-header"><span>Camera</span></div>
    <div class="panel-content">
      <div class="camera-mode-buttons">
        <button class="cam-mode-btn active" data-mode="orbit">Orbit</button>
        <button class="cam-mode-btn" data-mode="fly">Fly</button>
        <button class="cam-mode-btn" data-mode="fps">FPS</button>
        <button class="cam-mode-btn" data-mode="fixed">Fixed</button>
      </div>

      <div class="settings-slider">
        <label>Distance</label>
        <input type="range" id="camDistance" min="10" max="200" value="50" />
      </div>

      <div class="settings-slider">
        <label>Speed</label>
        <input type="range" id="camSpeed" min="0" max="2" step="0.1" value="0.5" />
      </div>

      <div class="settings-slider">
        <label>FOV</label>
        <input type="range" id="camFOV" min="30" max="120" value="75" />
      </div>
    </div>
  </div>

  <div id="visualizer-params" class="settings-panel" style="right:240px;">
    <div class="panel-header"><span>Visuals</span></div>
    <div class="panel-content">
      <div class="settings-slider">
        <label>Particle Size</label>
        <input type="range" id="particleSize" min="0.1" max="5" step="0.1" value="1" />
      </div>

      <div class="settings-slider">
        <label>Color Intensity</label>
        <input type="range" id="colorIntensity" min="0" max="2" step="0.1" value="1" />
      </div>

      <div class="settings-slider">
        <label>Bloom</label>
        <input type="range" id="bloomStrength" min="0" max="2" step="0.1" value="0.5" />
      </div>
    </div>
  </div>

  <!-- Three.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128/examples/js/postprocessing/EffectComposer.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128/examples/js/postprocessing/RenderPass.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128/examples/js/postprocessing/ShaderPass.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128/examples/js/postprocessing/UnrealBloomPass.js"></script>

  <!-- App -->
  <script src="js/DebugEngine.js"></script>
  <script src="js/AudioEngine.js"></script>
  <script src="js/VisualizerEngine.js"></script>
  <script src="js/RecorderEngine.js"></script>
  <script src="js/UIManager.js"></script>
  <script src="js/App.js"></script>

</body>
</html>
